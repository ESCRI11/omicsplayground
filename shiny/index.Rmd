---
title: "Omics Playground"
output: 
  flexdashboard::flex_dashboard:
    theme: default
    orientation: col
    logo: resources/bigomics-logo-white-48px.png
    favicon: resources/bigomics-logo-white-48px.png
    css: resources/playground.css
    includes:
      in_header: resources/cssloaders_in_header.html
runtime: shiny
---


```{r global=TRUE, echo=FALSE, message=FALSE, include=FALSE}
###```{r global, include=FALSE} 
## load data in 'global' chunk so it can be shared by all users of the dashboard
library(shiny)
library(rmarkdown)

##----------------------------------------------------------------------
## Add Javascript in header
##----------------------------------------------------------------------
tags$head(
         tags$link(rel="stylesheet", type="text/css",href="shinypass/style.css"),
         tags$script(type="text/javascript", src = "shinypass/md5.js"),
         tags$script(type="text/javascript", src = "shinypass/passwdInputBinding.js")
     )
##tags$style(HTML(".modal-backdrop.in { opacity: 0.9; }"))

##----------------------------------------------------------------------
## set folder path
##----------------------------------------------------------------------
all.dir = c("R","lib","pgx")
ROOT=NULL
if(all(dir.exists(paste0("/playground",all.dir)))==TRUE) ROOT="/playground"
if(all(dir.exists(paste0("../",all.dir)))==TRUE) ROOT=".."
if(all(dir.exists(all.dir))==TRUE) ROOT="."
ROOT
if(is.null(ROOT)) stop("FATAL ERROR: could not fine R/lib/pgx directories")
cat("setting ROOT to",ROOT,"\n")

RDIR = paste0(ROOT,"/R")
FILES = paste0(ROOT,"/lib/")
PGX.DIR = paste0(ROOT,"/pgx/")
##PGX.DIR = "../pgx-10k"

cat("setting RDIR =",RDIR,"\n")
cat("setting FILES =",FILES,"\n")
cat("setting PGX.DIR =",PGX.DIR,"\n")

source(file.path(RDIR,"pgx-init.R"), local=TRUE)
##PRO.VERSION=TRUE
##DEV.VERSION=TRUE

if(0) {
    load("../pgx/geiger2016-arginine.pgx")
    load("../pgx/GSE10846-dlbcl.pgx")
    load("../pgx/tcga-brca_pub-gx.pgx")
    load("../pgx/rieckmann2017-immprot.pgx")
    load("../pgx/GSE22886-immune.pgx")
    load("../pgx/GSE28492-roche.pgx")    
    load("../pgx/GSE32591-lupusnephritis.pgx")                
    
    ngs <- pgx.initialize(ngs)    
}

##----------------------------------------------------------------------
## Define modules to include
##----------------------------------------------------------------------
MODULES <- c(
    'module-home.Rmd',
    'module-dataview.Rmd',
    'module-clustering.Rmd',
    'module-expression.Rmd',
    'module-enrichment.Rmd',
    'module-intersection.Rmd',
    'module-functional.Rmd',
    'module-signature.Rmd',
    'module-biomarker.Rmd',
    'module-profiling.Rmd')

DEV_MODULES <- c(
    'module-correlation.Rmd',
    'module-batchcorrection.Rmd',
    'module-system.Rmd')

##if(DEV.VERSION) MODULES <- c(MODULES, DEV_MODULES)
cat("setting MODULES =",MODULES,"\n")

```

```{r child = MODULES}
```
